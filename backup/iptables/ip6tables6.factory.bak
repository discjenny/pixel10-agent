# Generated by ip6tables-save v1.8.11 on Fri Aug 29 11:13:20 2025
*mangle
:PREROUTING ACCEPT [3:228]
:INPUT ACCEPT [3:228]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [15:932]
:POSTROUTING ACCEPT [18:1160]
:bw_mangle_POSTROUTING - [0:0]
:connmark_mangle_INPUT - [0:0]
:connmark_mangle_OUTPUT - [0:0]
:idletimer_mangle_POSTROUTING - [0:0]
:oem_mangle_post - [0:0]
:routectrl_mangle_INPUT - [0:0]
:tetherctrl_mangle_FORWARD - [0:0]
:wakeupctrl_mangle_INPUT - [0:0]
-A INPUT -j connmark_mangle_INPUT
-A INPUT -j wakeupctrl_mangle_INPUT
-A INPUT -j routectrl_mangle_INPUT
-A FORWARD -j tetherctrl_mangle_FORWARD
-A OUTPUT -j connmark_mangle_OUTPUT
-A POSTROUTING -j oem_mangle_post
-A POSTROUTING -j bw_mangle_POSTROUTING
-A POSTROUTING -j idletimer_mangle_POSTROUTING
-A bw_mangle_POSTROUTING -o ipsec+ -j RETURN
-A bw_mangle_POSTROUTING -m policy --dir out --pol ipsec -j RETURN
-A bw_mangle_POSTROUTING -j MARK --set-xmark 0x0/0x100000
-A bw_mangle_POSTROUTING -m bpf --object-pinned /sys/fs/bpf/netd_shared/prog_netd_skfilter_egress_xtbpf
-A connmark_mangle_INPUT -m connmark --mark 0x0/0xfffff -j CONNMARK --save-mark --nfmask 0xfffff --ctmask 0xfffff
-A connmark_mangle_OUTPUT -m connmark --mark 0x0/0xfffff -j CONNMARK --save-mark --nfmask 0xfffff --ctmask 0xfffff
COMMIT
# Completed on Fri Aug 29 11:13:20 2025
# Generated by ip6tables-save v1.8.11 on Fri Aug 29 11:13:20 2025
*raw
:PREROUTING ACCEPT [3:228]
:OUTPUT ACCEPT [15:932]
:bw_raw_PREROUTING - [0:0]
:idletimer_raw_PREROUTING - [0:0]
:tetherctrl_raw_PREROUTING - [0:0]
-A PREROUTING -j idletimer_raw_PREROUTING
-A PREROUTING -j bw_raw_PREROUTING
-A PREROUTING -j tetherctrl_raw_PREROUTING
-A bw_raw_PREROUTING -m mark --mark 0xdeadc1a7 -j DROP
-A bw_raw_PREROUTING -i ipsec+ -j RETURN
-A bw_raw_PREROUTING -m policy --dir in --pol ipsec -j RETURN
-A bw_raw_PREROUTING -m bpf --object-pinned /sys/fs/bpf/netd_shared/prog_netd_skfilter_ingress_xtbpf
COMMIT
# Completed on Fri Aug 29 11:13:20 2025
# Generated by ip6tables-save v1.8.11 on Fri Aug 29 11:13:20 2025
*filter
:INPUT ACCEPT [3:228]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [15:932]
:bw_FORWARD - [0:0]
:bw_INPUT - [0:0]
:bw_OUTPUT - [0:0]
:bw_costly_shared - [0:0]
:bw_data_saver - [0:0]
:bw_global_alert - [0:0]
:bw_happy_box - [0:0]
:bw_penalty_box - [0:0]
:fw_FORWARD - [0:0]
:fw_INPUT - [0:0]
:fw_OUTPUT - [0:0]
:oem_fwd - [0:0]
:oem_in - [0:0]
:oem_out - [0:0]
:st_OUTPUT - [0:0]
:st_clear_caught - [0:0]
:st_clear_detect - [0:0]
:st_penalty_log - [0:0]
:st_penalty_reject - [0:0]
:tetherctrl_FORWARD - [0:0]
:tetherctrl_counters - [0:0]
-A INPUT -j oem_in
-A INPUT -j bw_INPUT
-A INPUT -j fw_INPUT
-A FORWARD -j oem_fwd
-A FORWARD -j fw_FORWARD
-A FORWARD -j bw_FORWARD
-A FORWARD -j tetherctrl_FORWARD
-A OUTPUT -j oem_out
-A OUTPUT -j fw_OUTPUT
-A OUTPUT -j st_OUTPUT
-A OUTPUT -j bw_OUTPUT
-A bw_INPUT -j bw_global_alert
-A bw_INPUT -p esp -j RETURN
-A bw_INPUT -m mark --mark 0x100000/0x100000 -j RETURN
-A bw_INPUT -j MARK --set-xmark 0x100000/0x100000
-A bw_OUTPUT -j bw_global_alert
-A bw_costly_shared -j bw_penalty_box
-A bw_data_saver -j RETURN
-A bw_global_alert -m quota2 ! --name globalAlert  --quota 2097152 
-A bw_happy_box -m bpf --object-pinned /sys/fs/bpf/netd_shared/prog_netd_skfilter_allowlist_xtbpf -j RETURN
-A bw_happy_box -j bw_data_saver
-A bw_penalty_box -m bpf --object-pinned /sys/fs/bpf/netd_shared/prog_netd_skfilter_denylist_xtbpf -j REJECT --reject-with icmp6-port-unreachable
-A bw_penalty_box -j bw_happy_box
-A fw_OUTPUT -s ::1/128 ! -o lo -j DROP
-A st_clear_detect -m connmark --mark 0x2000000/0x2000000 -j REJECT --reject-with icmp6-port-unreachable
-A st_clear_detect -m connmark --mark 0x1000000/0x1000000 -j RETURN
-A st_clear_detect -p tcp -m u32 --u32 "0x34>>0x1a&0x3c@0x28&0xffff0000=0x16030000&&0x34>>0x1a&0x3c@0x2c&0xff0000=0x10000" -j CONNMARK --set-xmark 0x1000000/0x1000000
-A st_clear_detect -p udp -m u32 --u32 "0x30&0xffff0000=0x16fe0000&&0x3c&0xff0000=0x10000" -j CONNMARK --set-xmark 0x1000000/0x1000000
-A st_clear_detect -m connmark --mark 0x1000000/0x1000000 -j RETURN
-A st_clear_detect -p tcp -m state --state ESTABLISHED -m u32 --u32 "0x34>>0x1a&0x3c@0x28&0x0=0x0" -j st_clear_caught
-A st_clear_detect -p udp -j st_clear_caught
-A st_penalty_log -j CONNMARK --set-xmark 0x1000000/0x1000000
-A st_penalty_log -j NFLOG
-A st_penalty_reject -j CONNMARK --set-xmark 0x2000000/0x2000000
-A st_penalty_reject -j NFLOG
-A st_penalty_reject -j REJECT --reject-with icmp6-port-unreachable
COMMIT
# Completed on Fri Aug 29 11:13:20 2025
